---
import BaseLayout from "../layouts/BaseLayout.astro";
import ContactCTA from "../components/ContactCTA.astro";
import Hero from "../components/Hero.astro";
import {
    contestData,
    educationData,
    certificateData, 
    algorithmContestData,
    problemCreationData,
    OnlineJudgeProfile,
} from "../data/about";
import "../styles/about.css";
---

<BaseLayout
    title="Dongwook Kim"
    description="About Dongwook Kim - Junior Embedded Developer"
>
    <div class="stack gap-20">
        <main class="wrapper about">
            <Hero title="Robotics" />
            <div style={{ margin: "4.5rem 0" }}></div>
            <section>
                <h2 class="section-title">제작한 ROS2 Pkg</h2>
                <br />
                <div class="content">
                    <div class="package-container">
                        <div class="package-item">
                            <div class="package-header">
                                <h3 class="package-title">RPLidar A1 Dual publish Pkg</h3>
                            </div>
                            <div class="package-description">
                                <p>RPLidar 2개를 Launch 파일로 묶은 패키지입니다.</p>
                            </div>
                            <div class="package-content">
                                <div class="media-grid">
                                    <div class="package-media overlay-media">
                                        <img src="/assets/robotics/A.png" alt="라이다 스프레이 패키지 이미지">
                                        <div class="media-overlay-text">패키지 구조도</div>
                                    </div>
                                    <div class="package-media overlay-media">
                                        <video src="/assets/robotics/D.webm" controls style="width:100%; border-radius:0.5rem;"></video>
                                        <div class="media-overlay-text">데이터 시각화</div>
                                    </div>
                                    <div class="package-media overlay-media">
                                        <img src="/assets/robotics/B.png" alt="센서 연결 예시">
                                        <div class="media-overlay-text">front Lidar</div>
                                    </div>
                                    <div class="package-media overlay-media">
                                        <img src="/assets/robotics/C.png" alt="실행 화면">
                                        <div class="media-overlay-text">rear Lidar</div>
                                    </div>
                                    
                                </div>
                            </div>
                        </div>

                        <div class="package-item">
                            <div class="package-header">
                                <h3 class="package-title">Dual Lidar Merge Pkg</h3>
                            </div>
                            <div class="package-description">
                                <p>2개의 라이다를 사용할 때 각각의 데이터를 융합하여 정확도가 높은 1개의 토픽으로 발행하는 패키지입니다.</p>
                            </div>
                            <div class="package-content">
                                <div class="package-media overlay-media">
                                    <video src="/assets/robotics/E.webm" controls style="width:100%; border-radius:0.5rem;"></video>
                                    <div class="media-overlay-text">데이터 시각화</div>
                                </div>
                            </div>
                            <div class="package-description">
                                <p>아직 물리적인 라이다의 위치 차이를 감안하지 못해서 중간의 레이저가 겹치는 이슈가 있음.</p>
                            </div>
                            <div class="package-description">
                                <p>아직 물리적인 라이다의 위치 차이를 감안하지 못해서 중간의 레이저가 겹치는 이슈가 있음.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <ContactCTA />
    </div>
</BaseLayout>

<script>
    function toggleProblems(id: string) {
        const problemList = document.getElementById(id);
        if (!problemList) return;

        const button = problemList.previousElementSibling as HTMLButtonElement;
        const arrow = button.querySelector(".arrow");

        problemList.classList.toggle("active");
        arrow?.classList.toggle("active");

        // 각 li 요소에 인덱스 설정
        problemList.querySelectorAll("li").forEach((li, index) => {
            li.style.setProperty("--item-index", index.toString());
        });
    }

    // 이벤트 위임을 사용하여 토글 버튼 클릭 처리
    document.addEventListener("click", (e) => {
        const target = e.target as HTMLElement;
        const toggleBtn = target.closest(".toggle-btn");

        if (toggleBtn) {
            const id = toggleBtn.getAttribute("data-id");
            if (id) toggleProblems(id);
        }
    });
</script>

<style>
    .package-container {
        max-width: 1200px;
        margin: 0;
        display: flex;
        flex-direction: column;
        gap: 3rem;
        padding: 0 1rem;
    }

    .package-item {
        background: var(--gray-800);
        border-radius: 1rem;
        overflow: hidden;
        transition: transform 0.3s ease;
        width: 100%;
    }

    .package-item:hover {
        transform: translateY(-5px);
    }

    .package-header {
        padding: 2rem;
        border-bottom: 1px solid var(--gray-700);
    }

    .package-description {
        padding: 1.5rem 2rem;
        background: var(--gray-750);
        border-bottom: 1px solid var(--gray-700);
    }

    .package-description p {
        color: var(--gray-300);
        line-height: 1.6;
        font-size: 1.1rem;
    }

    .package-title {
        font-size: 1.8rem;
        color: var(--gray-0);
        margin-bottom: 1rem;
        font-weight: 600;
    }

    .package-tags {
        display: flex;
        gap: 0.8rem;
        flex-wrap: wrap;
    }

    .tag {
        background: var(--gray-700);
        color: var(--gray-0);
        padding: 0.4rem 1rem;
        border-radius: 2rem;
        font-size: 0.9rem;
        font-weight: 500;
    }

    .package-content {
        display: flex;
        gap: 3rem;
        padding: 2rem;
    }

    .package-media {
        position: relative;
        width: 100%;
        max-width: 700px;
        margin: 0 auto;
    }

    .overlay-media img {
        width: 100%;
        height: auto;
        border-radius: 0.5rem;
        object-fit: cover;
        display: block;
    }

    .media-overlay-text {
        position: absolute;
        left: 0;
        bottom: 0;
        width: 100%;
        background: rgba(0,0,0,0.6);
        color: #fff;
        padding: 1rem 1.5rem;
        font-size: 1.1rem;
        border-radius: 0 0 0.5rem 0.5rem;
        box-sizing: border-box;
        text-align: left;
    }

    .package-info {
        flex: 0.7;
        display: flex;
        flex-direction: column;
        gap: 2rem;
    }

    .info-section h4 {
        color: var(--gray-0);
        font-size: 1.2rem;
        margin-bottom: 1rem;
        font-weight: 600;
    }

    .info-section ul {
        list-style-type: disc;
        padding-left: 1.5rem;
        color: var(--gray-300);
    }

    .info-section li {
        margin-bottom: 0.5rem;
        line-height: 1.5;
    }

    .info-section p {
        color: var(--gray-300);
        line-height: 1.5;
    }

    @media (max-width: 768px) {
        .package-content {
            flex-direction: column;
            padding: 1.5rem;
            gap: 2rem;
        }

        .package-header {
            padding: 1.5rem;
        }

        .package-title {
            font-size: 1.5rem;
        }

        .package-media {
            min-width: 100%;
            max-width: none;
        }

        .package-info {
            flex: 1;
        }
    }

    .section-title {
        display: block;
        width: 100%;
        max-width: none;
        font-size: var(--text-xl);
        color: var(--gray-0);
        margin-bottom: 2rem;
        font-weight: 700;
        line-height: 1.2;
        text-align: left;
        white-space: nowrap;
    }

    .media-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        margin: 2rem 0;
    }

    .package-media.overlay-media {
        width: 100%;
        max-width: 100%;
    }

    @media (max-width: 800px) {
        .media-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
